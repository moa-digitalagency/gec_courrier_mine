(.venv) PS C:\Users\HP400G4\gec> git fetch origin
(.venv) PS C:\Users\HP400G4\gec> git reset --hard origin/main
HEAD is now at 8957868 Update guide to force code updates without altering database or configuration
(.venv) PS C:\Users\HP400G4\gec> python fix_migration.py
C:\Users\HP400G4\AppData\Local\Programs\Python\Python311\python.exe: can't open file 'C:\\Users\\HP400G4\\gec\\fix_migration.py': [Errno 2] No such file or directory
(.venv) PS C:\Users\HP400G4\gec> git fetch origin
remote: Enumerating objects: 17, done.
remote: Counting objects: 100% (17/17), done.
remote: Compressing objects: 100% (5/5), done.
remote: Total 15 (delta 10), reused 15 (delta 10), pack-reused 0 (from 0)
Unpacking objects: 100% (15/15), 280.68 KiB | 402.00 KiB/s, done.
From https://github.com/moa-digitalagency/gec
   8957868..f2affe8  main       -> origin/main
(.venv) PS C:\Users\HP400G4\gec> git reset --hard origin/main
HEAD is now at f2affe8 Add new attached assets for various purposes
(.venv) PS C:\Users\HP400G4\gec> python fix_migration.py
üîÑ V√©rification et ajout des colonnes manquantes...

‚ùå Erreur pour 'smtp_server': no such table: parametres_systeme
‚ùå Erreur pour 'smtp_port': no such table: parametres_systeme
‚ùå Erreur pour 'smtp_use_tls': no such table: parametres_systeme
‚ùå Erreur pour 'smtp_username': no such table: parametres_systeme
‚ùå Erreur pour 'smtp_password': no such table: parametres_systeme
‚ùå Erreur pour 'appellation_departement': no such table: parametres_systeme

‚úÖ Migration termin√©e avec succ√®s !
üöÄ Vous pouvez maintenant red√©marrer l'application
(.venv) PS C:\Users\HP400G4\gec> python .\main.py
CRITICAL:root:NOUVELLE CL√â MA√éTRE G√âN√âR√âE - Configurez GEC_MASTER_KEY dans les variables d'environnement
CRITICAL:root:IMPORTANT: Cl√© g√©n√©r√©e automatiquement - configurez GEC_MASTER_KEY pour la persistence
CRITICAL:root:NOUVEAU SEL G√âN√âR√â - Configurez GEC_PASSWORD_SALT dans les variables d'environnement
CRITICAL:root:IMPORTANT: Sel g√©n√©r√© automatiquement - configurez GEC_PASSWORD_SALT pour la persistence
INFO:root:V√©rification des migrations automatiques...
DEBUG:root:Table migration_log existe d√©j√†
DEBUG:root:Table system_health existe d√©j√†
DEBUG:root:Colonne sendgrid_api_key existe d√©j√† dans parametres_systeme
DEBUG:root:Colonne email_provider existe d√©j√† dans parametres_systeme
DEBUG:root:Colonne notify_superadmin_new_mail existe d√©j√† dans parametres_systeme
DEBUG:root:Colonne titre_responsable_structure existe d√©j√† dans parametres_systeme
DEBUG:root:Colonne attached_file existe d√©j√† dans courrier_forward
DEBUG:root:Colonne attached_file_original_name existe d√©j√† dans courrier_forward
DEBUG:root:Colonne attached_file_size existe d√©j√† dans courrier_forward
INFO:root:‚úÖ Aucune migration n√©cessaire - Base de donn√©es √† jour
DEBUG:root:Contraintes de cl√©s √©trang√®res activ√©es pour SQLite
Traceback (most recent call last):
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: parametres_systeme.smtp_server

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\HP400G4\gec\main.py", line 1, in <module>
    from app import app
  File "C:\Users\HP400G4\gec\app.py", line 105, in <module>
    parametres = models.ParametresSysteme.get_parametres()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\models.py", line 845, in get_parametres
    parametres = ParametresSysteme.query.first()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2728, in first
    return self.limit(1)._iter().first()  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\orm\query.py", line 2827, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
                                                  ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2247, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 305, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\HP400G4\gec\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: parametres_systeme.smtp_server
[SQL: SELECT parametres_systeme.id AS parametres_systeme_id, parametres_systeme.nom_logiciel AS parametres_systeme_nom_logiciel, parametres_systeme.logo_url AS parametres_systeme_logo_url, parametres_systeme.mode_numero_accuse AS parametres_systeme_mode_numero_accuse, parametres_systeme.format_numero_accuse AS parametres_systeme_format_numero_accuse, parametres_systeme.adresse_organisme AS parametres_systeme_adresse_organisme, parametres_systeme.telephone AS parametres_systeme_telephone, parametres_systeme.email_contact AS parametres_systeme_email_contact, parametres_systeme.texte_footer AS parametres_systeme_texte_footer, parametres_systeme.copyright_crypte AS parametres_systeme_copyright_crypte, parametres_systeme.logo_pdf AS parametres_systeme_logo_pdf, parametres_systeme.titre_pdf AS parametres_systeme_titre_pdf, parametres_systeme.sous_titre_pdf AS parametres_systeme_sous_titre_pdf, parametres_systeme.pays_pdf AS parametres_systeme_pays_pdf, parametres_systeme.copyright_text AS parametres_systeme_copyright_text, parametres_systeme.smtp_server AS parametres_systeme_smtp_server, parametres_systeme.smtp_port AS parametres_systeme_smtp_port, parametres_systeme.smtp_use_tls AS parametres_systeme_smtp_use_tls, parametres_systeme.smtp_username AS parametres_systeme_smtp_username, parametres_systeme.smtp_password AS parametres_systeme_smtp_password, parametres_systeme.appellation_departement AS parametres_systeme_appellation_departement, parametres_systeme.titre_responsable_structure AS parametres_systeme_titre_responsable_structure, parametres_systeme.email_provider AS parametres_systeme_email_provider, parametres_systeme.sendgrid_api_key AS parametres_systeme_sendgrid_api_key, parametres_systeme.notify_superadmin_new_mail AS parametres_systeme_notify_superadmin_new_mail, parametres_systeme.date_modification AS parametres_systeme_date_modification, parametres_systeme.modifie_par_id AS parametres_systeme_modifie_par_id
FROM parametres_systeme
 LIMIT ? OFFSET ?]
[parameters: (1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
(.venv) PS C:\Users\HP400G4\gec>